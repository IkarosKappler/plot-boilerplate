/*!
 * PlotBoilerplate,
 * Git branch https://github.com/IkarosKappler/plotboilerplate/commit/3b21ccf
 */!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){i(2),i(3),i(4),i(5),i(6),i(7),i(8),i(9),i(10),i(11),i(12),i(13),i(14),i(15),i(16),i(17),t.exports=i(18)},function(t,e){Object.extendClass=function(t,e){var i=Object.getOwnPropertyNames(t.prototype);for(var s in i){var r=i[s];t.prototype.hasOwnProperty(r)&&r!==Object.extendClass&&(e.prototype[r]=t.prototype[r])}}},function(t,e){!function(t){"use strict";var e=function(){for(var t in this.draggable=!0,this.isSelected=!1,e.model)this[t]=e.model[t]};e.model={draggable:!0,isSelected:!1},t.VertexAttr=e}(window)},function(t,e){!function(t){"use strict";var e=function(t){this.drag=[],this.dragStart=[],this.dragEnd=[],this.vertex=t};e.prototype.addDragListener=function(t){this.drag.push(t)},e.prototype.addDragStartListener=function(t){this.dragStart.push(t)},e.prototype.addDragEndListener=function(t){this.dragEnd.push(t)},e.prototype.fireDragEvent=function(t){i(this,this.drag,t)},e.prototype.fireDragStartEvent=function(t){i(this,this.dragStart,t)},e.prototype.fireDragEndEvent=function(t){i(this,this.dragEnd,t)};var i=function(t,e,i){for(var s in void 0===i.params&&(i.params={}),i.params.vertex=t.vertex,e)e[s](i)};t.VertexListeners=e}(window)},function(t,e,i){(function(t){!function(t){"use strict";var e=function(t,e){"object"==typeof t&&"number"==typeof t.x&&"number"==typeof t.y?(this.x=t.x,this.y=t.y):(void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e),this.attr=new VertexAttr,this.listeners=new VertexListeners(this)};e.prototype.x=null,e.prototype.y=null,e.prototype.set=function(t,e){return"object"==typeof t&&"number"==typeof t.x&&"number"==typeof t.y?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),this},e.prototype.setX=function(t){return this.x=t,this},e.prototype.setY=function(t){return this.y=t,this},e.prototype.add=function(t,e){return"number"==typeof t?(this.x+=t,"number"==typeof e&&(this.y+=e)):(this.x+=t.x,this.y+=t.y),this},e.prototype.addXY=function(t,e){return this.x+=t,this.y+=e,this},e.prototype.sub=function(t,e){return"object"==typeof t&&"number"==typeof t.x&&"number"==typeof t.y?(this.x-=t.x,this.y-=t.y):(this.x-=t,this.y-=e),this},e.prototype.equals=function(t){var e=Math.abs(this.x-t.x)<1e-6,i=Math.abs(this.y-t.y)<1e-6;return e&&i},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.distance=function(t){return Math.sqrt(Math.pow(t.x-this.x,2)+Math.pow(t.y-this.y,2))},e.prototype.difference=function(t){return new e(t.x-this.x,t.y-this.y)},e.prototype.scale=function(t,i){return i&&void 0!==i||(i=new e(0,0)),this.x=i.x+(this.x-i.x)*t,this.y=i.y+(this.y-i.y)*t,this},e.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},e.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},e.prototype.inv=function(){return this.x=-this.x,this.y=-this.y,this},e.prototype.toString=function(){return"("+this.x+","+this.y+")"},e.prototype.toSVGString=function(t){t=t||{};var e=[];return e.push("<circle"),t.className&&e.push(' class="'+t.className+'"'),e.push(' cx="'+this.x+'"'),e.push(' cy="'+this.y+'"'),e.push(' r="2"'),e.push(" />"),e.join("")},e.randomVertex=function(t){return new e(t.min.x+Math.random()*(t.max.x-t.min.x),t.min.y+Math.random()*(t.max.y-t.min.y))},t.Vertex=e}(window||t.export)}).call(this,i(0)(t))},function(t,e,i){(function(t){var e,i;e=window||t.export,(i=function(t,e){this.center=t,this.size=e}).prototype.center=null,i.prototype.size=null,i.utils={baseLog:function(t,e){return Math.log(t)/Math.log(e)},mapRasterScale:function(t,e){var s=1;return e>=1?(s=Math.abs(Math.floor(1/i.utils.baseLog(t,e))),s=1/Math.pow(t,s)):s=Math.abs(Math.floor(i.utils.baseLog(1/t,1/(e+1)))),s}},e.Grid=i}).call(this,i(0)(t))},function(t,e,i){(function(t){!function(t){var e=function(t,e){this.a=t,this.b=e};e.prototype.a=null,e.prototype.b=null,e.prototype.length=function(){return Math.sqrt(Math.pow(this.b.x-this.a.x,2)+Math.pow(this.b.y-this.a.y,2))},e.prototype.sub=function(t){return this.a.sub(t),this.b.sub(t),this},e.prototype.add=function(t){return this.a.add(t),this.b.add(t),this},e.prototype.normalize=function(){return this.b.set(this.a.x+(this.b.x-this.a.x)/this.length(),this.a.y+(this.b.y-this.a.y)/this.length()),this},e.prototype.scale=function(t){return this.b.set(this.a.x+(this.b.x-this.a.x)*t,this.a.y+(this.b.y-this.a.y)*t),this},e.prototype.angle=function(t){var e=this.b.clone().sub(this.a),i=t.b.clone().sub(t.a);return Math.atan2(i.x,i.y)-Math.atan2(e.x,e.y)},e.prototype.vertAt=function(t){return new Vertex(this.a.x+(this.b.x-this.a.x)*t,this.a.y+(this.b.y-this.a.y)*t)},e.prototype.intersection=function(t){var e=this.denominator(t);if(0==e)return null;var i=this.a.y-t.a.y,s=this.a.x-t.a.x,r=(t.b.x-t.a.x)*i-(t.b.y-t.a.y)*s,n=(this.b.x-this.a.x)*i-(this.b.y-this.a.y)*s;return i=r/e,s=n/e,new Vertex(this.a.x+i*(this.b.x-this.a.x),this.a.y+i*(this.b.y-this.a.y))},e.prototype.denominator=function(t){return(t.b.y-t.a.y)*(this.b.x-this.a.x)-(t.b.x-t.a.x)*(this.b.y-this.a.y)},e.prototype.colinear=function(t){return Math.abs(this.denominator(t))<Vertex.EPSILON},e.prototype.getClosestT=function(t){var i=e.util.dist2(this.a,this.b);return 0===i?0:((t.x-this.a.x)*(this.b.x-this.a.x)+(t.y-this.a.y)*(this.b.y-this.a.y))/i},e.prototype.pointDistance=function(t){return Math.sqrt(function(t,e,i){return function(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)}(t,this.vertAt(this.getClosestLineT(t)))}(t,this.a,this.b))},e.prototype.clone=function(){return new e(this.a.clone(),this.b.clone())},e.prototype.toSVGString=function(t){t=t||{};var e=[];return e.push("<line"),t.className&&e.push(' class="'+t.className+'"'),e.push(' x1="'+this.a.x+'"'),e.push(' y1="'+this.a.y+'"'),e.push(' x2="'+this.b.x+'"'),e.push(' y2="'+this.b.y+'"'),e.push(" />"),e.join("")},this.toString=function(){return"{ a : "+this.a.toString()+", b : "+this.b.toString()+" }"},e.util={dist2:function(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)}},t.Line=e}(window||t.export)}).call(this,i(0)(t))},function(t,e,i){(function(t){!function(t){"use strict";var e=function(t,e){Line.call(this,t,e)};Object.extendClass(Line,e),e.prototype.perp=function(){var t=this.clone().sub(this.a);return new e(new Vertex,new Vertex(-t.b.y,t.b.x)).add(this.a)},e.prototype.inverse=function(){var t=this.a;return this.a=this.b,this.b=t,this},e.prototype.clone=function(){return new e(this.a.clone(),this.b.clone())},e.prototype.toSVGString=function(t){t=t||{};var e=[],i=PlotBoilerplate.utils.buildArrowHead(this.a,this.b,8,1,1);e.push("<g"),t.className&&e.push(' class="'+t.className+'"'),e.push(">"),e.push("   <line"),e.push(' x1="'+this.a.x+'"'),e.push(' y1="'+this.a.y+'"'),e.push(' x2="'+i[0].x+'"'),e.push(' y2="'+i[0].y+'"'),e.push(" />"),e.push('   <polygon points="');for(var s=0;s<i.length;s++)s>0&&e.push(" "),e.push(i[s].x+","+i[s].y);return e.push('"/>'),e.push("</g>"),e.join("")},t.Vector=e}(window||t.export)}).call(this,i(0)(t))},function(t,e){!function(t){"use strict";var e=function(t,e,i,s){this.startPoint=t,this.startControlPoint=i,this.endPoint=e,this.endControlPoint=s,this.curveIntervals=30,this.segmentCache=[],this.segmentLengths=[],this.arcLength=null,this.updateArcLengths()};e.START_POINT=0,e.START_CONTROL_POINT=1,e.END_CONTROL_POINT=2,e.END_POINT=3,e.prototype.constructor=e,e.prototype.START_POINT=0,e.prototype.START_CONTROL_POINT=1,e.prototype.END_CONTROL_POINT=2,e.prototype.END_POINT=3,e.prototype.moveCurvePoint=function(t,e,i,s){t==this.START_POINT?(this.getStartPoint().add(e),i&&this.getStartControlPoint().add(e)):t==this.START_CONTROL_POINT?this.getStartControlPoint().add(e):t==this.END_CONTROL_POINT?this.getEndControlPoint().add(e):t==this.END_POINT?(this.getEndPoint().add(e),i&&this.getEndControlPoint().add(e)):console.log("[IKRS.CubicBezierCurve.moveCurvePoint] pointID '"+t+"' invalid."),s&&this.updateArcLengths()},e.prototype.translate=function(t){this.startPoint.add(t),this.startControlPoint.add(t),this.endControlPoint.add(t),this.endPoint.add(t)},e.prototype.getLength=function(){return this.arcLength},e.prototype.updateArcLengths=function(){var t=new Vertex(this.startPoint.x,this.startPoint.y),e=new Vertex(0,0),i=1/this.curveIntervals;this.segmentCache=[],this.segmentCache.push(this.startPoint),this.segmentLengths=[],this.arcLength=0;for(var s=0;s<this.curveIntervals;s++){e=this.getPoint((s+1)*i),this.segmentCache.push(e);var r=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));this.segmentLengths.push(r),this.arcLength+=r,t=e,i}},e.prototype.getStartPoint=function(){return this.startPoint},e.prototype.getEndPoint=function(){return this.endPoint},e.prototype.getStartControlPoint=function(){return this.startControlPoint},e.prototype.getEndControlPoint=function(){return this.endControlPoint},e.prototype.getPointByID=function(t){if(t==this.START_POINT)return this.startPoint;if(t==this.END_POINT)return this.endPoint;if(t==this.START_CONTROL_POINT)return this.startControlPoint;if(t==this.END_CONTROL_POINT)return this.endControlPoint;throw"Invalid point ID '"+t+"'."},e.prototype.getPointAt=function(t){var e=this.startPoint.x*Math.pow(1-t,3)+3*this.startControlPoint.x*t*Math.pow(1-t,2)+3*this.endControlPoint.x*Math.pow(t,2)*(1-t)+this.endPoint.x*Math.pow(t,3),i=this.startPoint.y*Math.pow(1-t,3)+3*this.startControlPoint.y*t*Math.pow(1-t,2)+3*this.endControlPoint.y*Math.pow(t,2)*(1-t)+this.endPoint.y*Math.pow(t,3);return new Vertex(e,i)},e.prototype.getPoint=function(t){return this.getPointAt(t/this.arcLength)},e.prototype.getTangentAt=function(t){var e=this.getStartPoint(),i=this.getStartControlPoint(),s=this.getEndControlPoint(),r=this.getEndPoint(),n=t*t,o=1-2*t+n,a=-3*e.x*o+i.x*(3*o-6*(t-n))+s.x*(6*(t-n)-3*n)+3*r.x*n,h=-3*e.y*o+i.y*(3*o-6*(t-n))+s.y*(6*(t-n)-3*n)+3*r.y*n;return new Vertex(a,h)},e.prototype.convertU2T=function(t){return Math.max(0,Math.min(1,t/this.arcLength))},e.prototype.getTangent=function(t){return this.getTangentAt(this.convertU2T(t))},e.prototype.getPerpendicular=function(t){return this.getPerpendicularAt(this.convertU2T(t))},e.prototype.getPerpendicularAt=function(t){var e=this.getTangentAt(t);return new Vertex(e.y,-e.x)},e.prototype.clone=function(){return new e(this.getStartPoint().clone(),this.getEndPoint().clone(),this.getStartControlPoint().clone(),this.getEndControlPoint().clone())},e.prototype.equals=function(t){return!!t&&(!!(t.startPoint&&t.endPoint&&t.startControlPoint&&t.endControlPoint)&&(this.startPoint.equals(t.startPoint)&&this.endPoint.equals(t.endPoint)&&this.startControlPoint.equals(t.startControlPoint)&&this.endControlPoint.equals(t.endControlPoint)))},e.prototype.toSVGPathData=function(){var t=[];return t.push("M "),t.push(this.startPoint.x),t.push(" "),t.push(this.startPoint.y),t.push(" C "),t.push(this.startControlPoint.x),t.push(" "),t.push(this.startControlPoint.y),t.push(" "),t.push(this.endControlPoint.x),t.push(" "),t.push(this.endControlPoint.y),t.push(" "),t.push(this.endPoint.x),t.push(" "),t.push(this.endPoint.y),t.join("")},e.prototype.toJSON=function(t){return"{ "+(t?"\n\t":"")+'"startPoint" : ['+this.getStartPoint().x+","+this.getStartPoint().y+"], "+(t?"\n\t":"")+'"endPoint" : ['+this.getEndPoint().x+","+this.getEndPoint().y+"], "+(t?"\n\t":"")+'"startControlPoint": ['+this.getStartControlPoint().x+","+this.getStartControlPoint().y+"], "+(t?"\n\t":"")+'"endControlPoint" : ['+this.getEndControlPoint().x+","+this.getEndControlPoint().y+"]"+(t?"\n\t":"")+" }"},e.fromJSON=function(t){var i=JSON.parse(t);return e.fromObject(i)},e.fromObject=function(t){if("object"!=typeof t)throw"[IKRS.CubicBezierCurve.fromObject] Can only build from object.";if(!t.startPoint)throw'[IKRS.CubicBezierCurve.fromObject] Object member "startPoint" missing.';if(!t.endPoint)throw'[IKRS.CubicBezierCurve.fromObject] Object member "endPoint" missing.';if(!t.startControlPoint)throw'[IKRS.CubicBezierCurve.fromObject] Object member "startControlPoint" missing.';if(!t.endControlPoint)throw'[IKRS.CubicBezierCurve.fromObject] Object member "endControlPoint" missing.';return new e(new Vertex(t.startPoint[0],t.startPoint[1]),new Vertex(t.endPoint[0],t.endPoint[1]),new Vertex(t.startControlPoint[0],t.startControlPoint[1]),new Vertex(t.endControlPoint[0],t.endControlPoint[1]))},e.fromArray=function(t){if(!Array.isArray(t))throw"[IKRS.CubicBezierCurve.fromArray] Can only build from object.";if(4!=t.length)throw"[IKRS.CubicBezierCurve.fromArray] Can only build from array with four elements.";return new e(t[0],t[1],t[2],t[3])},t.CubicBezierCurve=e}(window)},function(t,e){!function(t){"use strict";var e=function(t){t||(t=[]),this.totalArcLength=0,this.adjustCircular=!1,this.bezierCurves=[];for(var e=1;e<t.length;e++){var i=new THREE.Box2(t[e].x-t[e-1].x,t[e].y-t[e-1].y),s=new CubicBezierCurve(t[e-1],t[e],new Vertex(t[e-1].x,t[e-1].y-i.min/2),new Vertex(t[e].x+i.max/2,t[e].y));this.bezierCurves.push(s),this.totalArcLength+=s.getLength(),this.bezierCurves.length>=2&&this.adjustSuccessorControlPoint(this.bezierCurves.length-2,!0,!0)}};e.prototype.constructor=e,e.START_POINT=0,e.START_CONTROL_POINT=1,e.END_CONTROL_POINT=2,e.END_POINT=3,e.prototype.START_POINT=0,e.prototype.START_CONTROL_POINT=1,e.prototype.END_CONTROL_POINT=2,e.prototype.END_POINT=3,e.prototype.addCurve=function(t){if(null==t||void 0===t)throw"Cannot add null curve to bézier path.";this.bezierCurves.push(t),this.bezierCurves.length>1?(t.startPoint=this.bezierCurves[this.bezierCurves.length-2].endPoint,this.adjustSuccessorControlPoint(this.bezierCurves.length-2,!0,!0)):this.totalArcLength+=t.getLength()},e.prototype.locateCurveByStartPoint=function(t){for(var e in this.bezierCurves)if(this.bezierCurves[e].startPoint.equals(t))return e;return-1},e.prototype.locateCurveByStartControlPoint=function(t){for(var e in this.bezierCurves)if(this.bezierCurves[e].startControlPoint.equals(t))return e;return-1},e.prototype.locateCurveByEndControlPoint=function(t){for(var e in this.bezierCurves)if(this.bezierCurves[e].endControlPoint.equals(t))return e;return-1},e.prototype.getLength=function(){return this.totalArcLength},e.prototype.updateArcLengths=function(){this.totalArcLength=0;for(var t=0;t<this.bezierCurves.length;t++)this.bezierCurves[t].updateArcLengths(),this.totalArcLength+=this.bezierCurves[t].getLength()},e.prototype.getCurveCount=function(){return this.bezierCurves.length},e.prototype.getCurveAt=function(t){return this.bezierCurves[t]},e.prototype.removeEndPoint=function(){if(this.bezierCurves.length<=1)return!1;for(var t=[this.bezierCurves.length-1],e=0;e<this.bezierCurves.length-1;e++)t[e]=this.bezierCurves[e];return this.totalArcLength-=this.bezierCurves[this.bezierCurves.length-1].getLength(),this.bezierCurves=t,!0},e.prototype.removeStartPoint=function(){if(this.bezierCurves.length<=1)return!1;for(var t=[this.bezierCurves.length-1],e=1;e<this.bezierCurves.length;e++)t[e-1]=this.bezierCurves[e];return this.totalArcLength-=this.bezierCurves[0].getLength(),this.bezierCurves=t,!0},e.prototype.joinAt=function(t){if(t<0||t>=this.bezierCurves.length)return!1;var e=this.bezierCurves[t-1],i=this.bezierCurves[t],s=e.getStartControlPoint().clone();s.sub(e.getStartPoint()),s.multiplyScalar(2),s.add(e.getStartPoint());var r=i.getEndControlPoint().clone();r.sub(i.getEndPoint()),r.multiplyScalar(2),r.add(i.getEndPoint());for(var n=new IKRS.CubicBezierCurve(e.getStartPoint(),i.getEndPoint(),s,r),o=[this.bezierCurves.length-1],a=0;a<t-1;a++)o[a]=this.bezierCurves[a];o[t-1]=n;for(a=t;a+1<this.bezierCurves.length;a++)o[a]=this.bezierCurves[a+1];return this.bezierCurves=o,this.updateArcLengths(),!0},e.prototype.splitAt=function(t,e){if(t<0||t>=this.bezierCurves.length)return!1;var i=this.bezierCurves[t];if(e<1||e-1>=i.segmentCache.length)return!1;for(var s=this.bezierCurves.length;s>t;s--)this.bezierCurves[s]=this.bezierCurves[s-1];for(var r=0,n=0;n<e;n++)r+=i.segmentLengths[n];var o=i.getTangent(r);o=o.multiplyScalar(.25);var a=i.segmentCache[e].clone();a.sub(o);var h=i.segmentCache[e].clone();h.add(o);var l=i.getStartControlPoint().clone();l.sub(i.getStartPoint()),l.multiplyScalar(.25),l.add(i.getStartPoint());var c=i.getEndControlPoint().clone();c.sub(i.getEndPoint()),c.multiplyScalar(.25),c.add(i.getEndPoint());var u=new CubicBezierCurve(i.getStartPoint(),i.segmentCache[e],l,a),f=new CubicBezierCurve(i.segmentCache[e],i.getEndPoint(),h,c);return this.bezierCurves[t]=u,this.bezierCurves[t+1]=f,this.totalArcLength-=i.getLength(),this.totalArcLength+=u.getLength(),this.totalArcLength+=f.getLength(),!0},e.prototype.translate=function(t){for(var e=0;e<this.bezierCurves.length;e++){(i=this.bezierCurves[e]).getStartPoint().add(t),i.getStartControlPoint().add(t),i.getEndControlPoint().add(t)}var i;(i=this.bezierCurves[this.bezierCurves.length-1]).getEndPoint().add(t),this.updateArcLengths()},e.prototype.scale=function(t,i){for(var s=0;s<this.bezierCurves.length;s++){var r=this.bezierCurves[s];e._scalePoint(r.getStartPoint(),t,i),e._scalePoint(r.getStartControlPoint(),t,i),e._scalePoint(r.getEndControlPoint(),t,i)}this.bezierCurves.length>0&&e._scalePoint(this.bezierCurves[this.bezierCurves.length-1].getEndPoint(),t,i),this.updateArcLengths()},e._scalePoint=function(t,e,i){t.sub(e),t.setX(t.x*i.x),t.setY(t.y*i.y),t.add(e)},e.prototype.getPoint=function(t){if(t<0||t>this.totalArcLength)return console.log("[BezierPath.getPoint(u)] u is out of bounds: "+t+"."),null;for(var e=0,i=0;e<this.bezierCurves.length&&i+this.bezierCurves[e].getLength()<t;)i+=this.bezierCurves[e].getLength(),e++;if(e>=this.bezierCurves.length)return this.bezierCurves[this.bezierCurves.length-1].getEndPoint().clone();var s=t-i;return this.bezierCurves[e].getPoint(s)},e.prototype.getPointAt=function(t){return this.getPoint(t*this.totalArcLength)},e.prototype.getTangentAt=function(t){return this.getTangent(t*this.totalArcLength)},e.prototype.getTangent=function(t){if(t<0||t>this.totalArcLength)return console.warn("[BezierPath.getTangent(u)] u is out of bounds: "+t+"."),null;for(var e=0,i=0;e<this.bezierCurves.length&&i+this.bezierCurves[e].getLength()<t;)i+=this.bezierCurves[e].getLength(),e++;var s=t-i;return this.bezierCurves[e].getTangent(s)},e.prototype.getPerpendicularAt=function(t){return this.getPerpendicular(t*this.totalArcLength)},e.prototype.getPerpendicular=function(t){if(t<0||t>this.totalArcLength)return console.log("[IKRS.BezierPath.getPerpendicular(u)] u is out of bounds: "+t+"."),null;for(var e=0,i=0;e<this.bezierCurves.length&&i+this.bezierCurves[e].getLength()<t;)i+=this.bezierCurves[e].getLength(),e++;var s=t-i;return this.bezierCurves[e].getPerpendicular(s)},e.prototype.moveCurvePoint=function(t,e,i){if(this.getCurveAt(t).moveCurvePoint(e,i,!0,!0),e==this.START_POINT&&(t>0||this.adjustCircular))this.getCurveAt(t-1<0?this.bezierCurves.length+(t-1):t-1).moveCurvePoint(this.END_CONTROL_POINT,i,!0,!1);else if(e==this.END_POINT&&(t+1<this.bezierCurves.length||this.adjustCircular)){this.getCurveAt((t+1)%this.bezierCurves.length).moveCurvePoint(this.START_CONTROL_POINT,i,!0,!1)}else e==this.START_CONTROL_POINT&&t>0?this.adjustPredecessorControlPoint(t,!0,!1):e==this.END_CONTROL_POINT&&t+1<this.getCurveCount()&&this.adjustSuccessorControlPoint(t,!0,!1);this.updateArcLengths()},e.prototype.adjustPredecessorControlPoint=function(t,e,i){if(!this.adjustCircular&&t<=0)return!1;var s=this.getCurveAt(t),r=this.getCurveAt(t-1<0?this.getCurveCount()+(t-1):t-1);this.adjustNeighbourControlPoint(s,r,s.getStartPoint(),s.getStartControlPoint(),r.getEndPoint(),r.getEndControlPoint(),e,i)},e.prototype.adjustSuccessorControlPoint=function(t,e,i){if(!this.adjustCirculat&&t+1>this.getCurveCount())return!1;var s=this.getCurveAt(t),r=this.getCurveAt((t+1)%this.getCurveCount());return this.adjustNeighbourControlPoint(s,r,s.getEndPoint(),s.getEndControlPoint(),r.getStartPoint(),r.getStartControlPoint(),e,i)},e.prototype.adjustNeighbourControlPoint=function(t,e,i,s,r,n,o,a){var h=new Vertex(s.x-i.x,s.y-i.y),l=new Vertex(n.x-r.x,n.y-r.y),c=Math.sqrt(Math.pow(h.x,2)+Math.pow(h.y,2)),u=Math.sqrt(Math.pow(l.x,2)+Math.pow(l.y,2));c<=.1||(n.set(r.x-h.x*(u/c),r.y-h.y*(u/c)),e.updateArcLengths())},e.prototype.clone=function(){for(var t=new e(null),i=0;i<this.bezierCurves.length;i++)t.bezierCurves.push(this.bezierCurves[i].clone()),i>0&&(t.bezierCurves[i-1].endPoint=t.bezierCurves[i].startPoint);return t.updateArcLengths(),t},e.prototype.equals=function(t){if(!t)return!1;if(!t.bezierCurves)return!1;if(void 0===t.bezierCurves.length)return!1;if(t.bezierCurves.length!=this.bezierCurves.length)return!1;for(var e=0;e<this.bezierCurves.length;e++)if(!this.bezierCurves[e].equals(t.bezierCurves[e]))return!1;return!0},e.prototype.toSVGString=function(t){t=t||{};var e=[];e.push("<path"),t.className&&e.push(' class="'+t.className+'"'),e.push(' d="');for(var i=0;i<this.bezierCurves.length;i++)i>0&&e.push(" "),e.push(this.bezierCurves[i].toSVGPathData());return e.push('" />'),e.join("")},e.prototype.toJSON=function(t){var e=[];e.push("[");for(var i=0;i<this.bezierCurves.length;i++)i>0&&e.push(","),t?e.push("\n\t"):e.push(" "),e.push(this.bezierCurves[i].toJSON(t));return 0!=this.bezierCurves.length&&e.push(" "),e.push("]"),e.join("")},e.fromJSON=function(t){var e=JSON.parse(t);return IKRS.BezierPath.fromArray(e)},e.fromArray=function(t){if(!Array.isArray(t))throw"[BezierPath.fromArray] Passed object must be an array.";if(t.length<1)throw"[BezierPath.fromArray] Passed array must contain at least one bezier curve (has "+t.length+").";for(var i=new e(null),s=null,r=0;r<t.length;r++){var n=null;if(0 in t[r]&&1 in t[r]&&2 in t[r]&&3 in t[r]){if(!(t[r][0]&&t[r][1]&&t[r][2]&&t[r][3]))throw"Cannot convert path data to BezierPath instance. At least one element is undefined (index="+r+"): "+t[r];n=CubicBezierCurve.fromArray(t[r])}else n=CubicBezierCurve.fromObject(t[r]);s&&(n.startPoint=s.endPoint),i.bezierCurves.push(n),i.totalArcLength+=n.getLength(),s=n}return i},e.prototype.toReducedListRepresentation=function(t){void 0===t&&(t=1);var i=[];i.push("[");for(var s=0;s<this.bezierCurves.length;s++){var r=this.bezierCurves[s];i.push(e._roundToDigits(r.getStartPoint().x,t,!1)),i.push(","),i.push(e._roundToDigits(r.getStartPoint().y,t,!1)),i.push(","),i.push(e._roundToDigits(r.getStartControlPoint().x,t,!1)),i.push(","),i.push(IKRS.BezierPath._roundToDigits(r.getStartControlPoint().y,t,!1)),i.push(","),i.push(e._roundToDigits(r.getEndControlPoint().x,t,!1)),i.push(","),i.push(e._roundToDigits(r.getEndControlPoint().y,t,!1)),i.push(",")}if(0!=this.bezierCurves.length){r=this.bezierCurves[this.bezierCurves.length-1];i.push(e._roundToDigits(r.getEndPoint().x,t,!1)),i.push(","),i.push(e._roundToDigits(r.getEndPoint().y,t,!1))}return i.push("]"),i.join("")},e.fromReducedListRepresentation=function(t){var i=JSON.parse(t);if(!i.length)throw console.log("Cannot parse bezier path from non-array object nor from empty point list."),"Cannot parse bezier path from non-array object nor from empty point list.";if(i.length<8)throw console.log("Cannot build bezier path. The passed array must contain at least 8 elements (numbers)."),"Cannot build bezier path. The passed array must contain at least 8 elements (numbers).";var s=new e(null),r=null,n=null,o=null,a=null,h=0;do{0==h&&(r=new Vertex(i[h],i[h+1])),n=new Vertex(i[h+2],i[h+3]),o=new Vertex(i[h+4],i[h+5]),a=new Vertex(i[h+6],i[h+7]);var l=new CubicBezierCurve(r,a,n,o);s.bezierCurves.push(l),r=a,h+=6}while(h+2<i.length);return s.updateArcLengths(),s},e._roundToDigits=function(t,e,i){if(e<=0)return Math.round(t);var s=Math.pow(10,e),r=""+(t=Math.round(t*s))/s,n=r.lastIndexOf(".");if(-1==n&&(n=r.length),i)for(var o=i-(r.length-n-1);o-- >0;)r+="&nbsp;";return r},t.BezierPath=e}(window)},function(t,e,i){(function(t){!function(t){"use strict";var e=function(t,e){void 0===t&&(t=[]),this.vertices=t,this.isOpen=e};e.prototype.vertices=null,e.prototype.isOpen=!1,t.Polygon=e,t.Polygon.prototype.containsVert=function(t){for(var e=!1,i=0,s=this.vertices.length-1;i<this.vertices.length;s=i++){var r=this.vertices[i].x,n=this.vertices[i].y,o=this.vertices[s].x,a=this.vertices[s].y;n>t.y!=a>t.y&&t.x<(o-r)*(t.y-n)/(a-n)+r&&(e=!e)}return e},t.Polygon.prototype.scale=function(t,e){for(var i in this.vertices)"function"==typeof this.vertices[i].scale?this.vertices[i].scale(t,e):console.log("There seems to be a null vertex!",this.vertices[i]);return this},t.Polygon.prototype.toQuadraticBezierData=function(){if(this.vertices.length<3)return[];var t=[],e=this.vertices[0],i=this.vertices[1],s=new Vertex(e.x+(i.x-e.x)/2,e.y+(i.y-e.y)/2);t.push(s);for(var r=this.isOpen?this.vertices.length:this.vertices.length+1,n=1;n<r;n++){e=this.vertices[n%this.vertices.length],i=this.vertices[(n+1)%this.vertices.length];s=new Vertex(e.x+(i.x-e.x)/2,e.y+(i.y-e.y)/2);t.push(e),t.push(s),e=i}return t},t.Polygon.prototype.toQuadraticBezierSVGString=function(){var t=this.toQuadraticBezierData();if(0==t.length)return"";for(var e=["M "+t[0].x+" "+t[0].y],i=1;i<t.length;i+=2)e.push("Q "+t[i].x+" "+t[i].y+", "+t[i+1].x+" "+t[i+1].y);return e.join(" ")},t.Polygon.prototype.toCubicBezierData=function(t){if(void 0===t&&(t=1),this.vertices.length<3)return[];var e=[],i=this.vertices[0],s=this.vertices[1],r=new Vertex(i.x+(s.x-i.x)/2,i.y+(s.y-i.y)/2);e.push(r);for(var n=this.isOpen?this.vertices.length-1:this.vertices.length,o=0;o<n;o++){i=this.vertices[o%this.vertices.length],s=this.vertices[(o+1)%this.vertices.length];var a=this.vertices[(o+2)%this.vertices.length],h=new Vertex(i.x+(s.x-i.x)/2,i.y+(s.y-i.y)/2),l=new Vertex(s.x+(a.x-s.x)/2,s.y+(a.y-s.y)/2),c=new Vertex(h.x+(s.x-h.x)*t,h.y+(s.y-h.y)*t),u=new Vertex(l.x+(s.x-l.x)*t,l.y+(s.y-l.y)*t);e.push(c),e.push(u),e.push(l)}return e},t.Polygon.prototype.toCubicBezierSVGString=function(t){var e=this.toCubicBezierData(t);if(0==e.length)return"";for(var i=["M "+e[0].x+" "+e[0].y],s=1;s<e.length;s+=3)i.push("C "+e[s].x+" "+e[s].y+", "+e[s+1].x+" "+e[s+1].y+", "+e[s+2].x+" "+e[s+2].y);return i.join(" ")},t.Polygon.prototype.toCubicBezierPath=function(t){for(var e=this.toCubicBezierData(t),i=[],s=0;s+3<e.length;s+=3)i.push([e[s],e[s+3],e[s+1],e[s+2]]);return BezierPath.fromArray(i)},t.Polygon.prototype.toSVGString=function(t){t=t||{};var e=[];if(e.push("<path"),t.className&&e.push(' class="'+t.className+'"'),e.push(' d="'),this.vertices.length>0){e.push("M "),e.push(this.vertices[0].x),e.push(" "),e.push(this.vertices[0].y);for(var i=1;i<this.vertices.length;i++)e.push(" L "),e.push(this.vertices[i].x),e.push(" "),e.push(this.vertices[i].y);this.isOpen||e.push(" Z")}return e.push('" />'),e.join("")}}(window||t.export)}).call(this,i(0)(t))},function(t,e,i){(function(t){var e,i;e=window||t.export,(i=function(t,e){this.center=t,this.axis=e}).prototype.center=null,i.prototype.axis=null,i.prototype.toSVGString=function(t){t=t||{};var e=[];return e.push("<ellipse"),t.className&&e.push(' class="'+t.className+'"'),e.push(' cx="'+this.center.x+'"'),e.push(' cy="'+this.center.y+'"'),e.push(' rx="'+this.axis.x+'"'),e.push(' ry="'+this.axis.y+'"'),e.push(" />"),e.join("")},e.VEllipse=i}).call(this,i(0)(t))},function(t,e,i){(function(t){!function(e){"use strict";(window?window:t.export).PBImage=function(t,e,i){if(void 0===t)throw Error("image must not be null.");if(void 0===e)throw Error("upperLeft must not be null.");if(void 0===i)throw Error("lowerRight must not be null.");this.image=t,this.upperLeft=e,this.lowerRight=i}}()}).call(this,i(0)(t))},function(t,e){!function(t){window.MouseHandler=function(t){var e=null,i=null,s=-1,r={},n={},o={};function a(t){return{x:t.pageX-t.target.offsetLeft,y:t.pageY-t.target.offsetTop}}function h(r,n){var o=a(r);return r.params={element:t,name:n,pos:o,button:s,leftButton:0==s,middleButton:1==s,rightButton:2==s,mouseDownPos:e,draggedFrom:i,wasDragged:null!=e&&(e.x!=o.x||e.y!=o.y),dragAmount:null!=e?{x:o.x-i.x,y:o.y-i.y}:{x:0,y:0}},r}function l(e){n[e]||(t.addEventListener(e,o[e]),n[e]=!0)}function c(e){n[e]&&(t.removeEventListener(e,o[e]),delete n[e])}function u(t){throw"This MouseHandler already has a '"+t+"' callback. To keep the code simple there is only room for one."}o.mousemove=function(t){r.mousemove&&r.mousemove(h(t,"mousemove")),i&&r.drag&&r.drag(h(t,"drag")),e&&(i=a(t))},o.mouseup=function(t){r.mouseup&&r.mouseup(h(t,"mouseup")),i=null,e=null,s=-1},o.mousedown=function(t){i=a(t),e=a(t),s=t.button,r.mousedown&&r.mousedown(h(t,"mousedown"))},o.click=function(t){r.click&&r.click(h(t,"mousedown"))},o.wheel=function(t){r.wheel&&r.wheel(h(t,"wheel"))},this.drag=function(t){return r.drag&&u("drag"),r.drag=t,l("mousedown"),l("mousemove"),l("mouseup"),this},this.move=function(t){return r.mousemove&&u("mousemove"),l("mousemove"),r.mousemove=t,this},this.up=function(t){return r.mouseup&&u("mouseup"),l("mouseup"),r.mouseup=t,this},this.down=function(t){return r.mousedown&&u("mousedown"),l("mousedown"),r.mousedown=t,this},this.click=function(t){return r.click&&u("click"),l("click"),r.click=t,this},this.wheel=function(t){return r.wheel&&u("wheel"),l("wheel"),r.wheel=t,this},this.destroy=function(){c("mousedown"),c("mousemove"),c("moseup"),c("click"),c("wheel")}}}()},function(t,e){!function(t){"use strict";var e=function(t){t=t||{},this.element=t.element?t.element:window,this.downListeners=[],this.pressListeners=[],this.upListeners=[],this.keyStates=[],this.trackAllKeys=t.trackAll||!1,this._keyDownListener=null,this._keyPressListener=null,this._keyUpListener=null,this.installListeners()},i=function(t,e){var i=!1;for(var s in e){var r=e[s];r.keyCode==t.keyCode&&(r.listener(t),i=!0)}return i},s=function(t){if("number"==typeof t)return t;if("string"!=typeof t)throw"Unknown key name or key type (should be a string or integer): "+t;if(e.KEY_CODES[t])return e.KEY_CODES[t];throw"Unknown key (cannot resolve key code): "+t};e.KEY_CODES={break:3,backspace:8,delete:8,tab:9,clear:12,enter:13,shift:16,ctrl:17,alt:18,pause:19,break:19,capslock:20,hangul:21,hanja:25,escape:27,conversion:28,"non-conversion":29,spacebar:32,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,select:41,print:42,execute:43,printscreen:44,insert:45,delete:46,help:47,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,":":58,"semicolon (firefox)":59,equals:59,"<":60,"equals (firefox)":61,"ß":63,"@ (firefox)":64,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,windows:91,leftcommand:91,chromebooksearch:91,rightwindowkey:92,windowsmenu:93,rightcommant:93,sleep:95,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,numpadperiod:108,subtract:109,decimalpoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,f13:124,f14:125,f15:126,f16:127,f17:128,f18:129,f19:130,f20:131,f21:132,f22:133,f23:134,f24:135,numlock:144,scrolllock:145,"^":160,"!":161,"#":163,$:164,"ù":165,pagebackward:166,pageforward:167,refresh:168,closingparen:169,"*":170,"~+*":171,home:172,minus:173,mute:173,unmute:173,decreasevolumelevel:174,increasevolumelevel:175,next:176,previous:177,stop:178,"play/pause":179,email:180,mute:181,unmute:181,semicolon:186,"ñ":186,equal:187,comma:188,dash:189,period:190,forwardslash:191,"ç":191,"grave accent":192,"æ":192,"ö":192,"?":193,"/":193,"°":193,numpadperiod:194,openbracket:219,backslash:220,closebracket:221,"å":221,singlequote:222,"ø":222,"ä":222,"`":223,altgr:225,"GNOME Compose Key":230,"ç":231,XF86Forward:233,XF86Back:234,"non-conversion":235,alphanumeric:240,hiragana:242,katakana:242,"half-width":243,"full-width":243,kanji:244,unlocktrackpad:251,toggletouchpad:255},e.prototype.installListeners=function(){var t=this;this.element.addEventListener("keydown",this.keyDownListener=function(e){!function(t,e){(i(t,e.downListeners)||e.trackAllKeys)&&(e.keyStates[t.keyCode]="down")}(e,t)}),this.element.addEventListener("keypress",this.keyPressListener=function(e){!function(t,e){i(t,e.pressListeners)}(e,t)}),this.element.addEventListener("keyup",this.keyUpListener=function(e){!function(t,e){(i(t,e.upListeners)||e.trackAllKeys)&&delete e.keyStates[t.keyCode]}(e,t)})},e.prototype.releaseListeners=function(){this.element.removeEventListener("keydown",this.keyDownListener),this.element.removeEventListener("keypress",this.keyPressListener),this.element.removeEventListener("keyup",this.keyUpListener)},e.prototype.down=function(t,e){return this.downListeners.push({key:t,keyCode:s(t),listener:e}),this},e.prototype.press=function(t,e){return this.pressListeners.push({key:t,keyCode:s(t),listener:e}),this},e.prototype.up=function(t,e){return this.upListeners.push({key:t,keyCode:s(t),listener:e}),this},e.prototype.isDown=function(t){return!!this.keyStates[s(t)]},t.KeyHandler=e}(window)},function(t,e,i){(function(t){!function(t){"use strict";t.drawutils=function(t,e){this.ctx=t,this.offset=new Vertex(0,0),this.scale=new Vertex(1,1),this.fillShapes=e},t.drawutils.prototype.beginDrawCycle=function(){},t.drawutils.prototype.line=function(t,e,i){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+e.x*this.scale.x,this.offset.y+e.y*this.scale.y),this.ctx.strokeStyle=i,this.ctx.lineWidth=1,this.ctx.stroke(),this.ctx.restore()},t.drawutils.prototype.arrow=function(t,e,i){var s=PlotBoilerplate.utils.buildArrowHead(t,e,8,this.scale.x,this.scale.y);this.ctx.save(),this.ctx.beginPath();s=PlotBoilerplate.utils.buildArrowHead(t,e,8,this.scale.x,this.scale.y);this.ctx.moveTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y);for(var r=0;r<s.length;r++)this.ctx.lineTo(this.offset.x+s[r].x,this.offset.y+s[r].y);this.ctx.lineTo(this.offset.x+s[0].x,this.offset.y+s[0].y),this.ctx.lineWidth=1,this._fillOrDraw(i),this.ctx.restore()},t.drawutils.prototype.image=function(t,e,i){this.ctx.save(),this.ctx.drawImage(t,0,0,t.naturalWidth,t.naturalHeight,this.offset.x+e.x*this.scale.x,this.offset.y+e.y*this.scale.y,i.x*this.scale.x,i.y*this.scale.y),this.ctx.restore()},t.drawutils.prototype._fillOrDraw=function(t){this.fillShapes?(this.ctx.fillStyle=t,this.ctx.fill()):(this.ctx.strokeStyle=t,this.ctx.stroke())},t.drawutils.prototype.cubicBezier=function(t,e,i,s,r){t instanceof CubicBezierCurve?this.cubicBezier(t.startPoint,t.endPoint,t.startControlPoint,t.endControlPoint,e):(this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y),this.ctx.bezierCurveTo(this.offset.x+i.x*this.scale.x,this.offset.y+i.y*this.scale.y,this.offset.x+s.x*this.scale.x,this.offset.y+s.y*this.scale.y,this.offset.x+e.x*this.scale.x,this.offset.y+e.y*this.scale.y),this.ctx.lineWidth=2,this._fillOrDraw(r),this.ctx.restore())},t.drawutils.prototype.cubicBezierPath=function(t,e){if(t&&0!=t.length){var i,s,r;this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t[0].x*this.scale.x,this.offset.y+t[0].y*this.scale.y);for(var n=1;n<t.length;n+=3)s=t[n],r=t[n+1],i=t[n+2],this.ctx.bezierCurveTo(this.offset.x+s.x*this.scale.x,this.offset.y+s.y*this.scale.y,this.offset.x+r.x*this.scale.x,this.offset.y+r.y*this.scale.y,this.offset.x+i.x*this.scale.x,this.offset.y+i.y*this.scale.y);this.ctx.closePath(),this.ctx.lineWidth=1,this._fillOrDraw(e),this.ctx.restore()}},t.drawutils.prototype.handle=function(t,e){this.point(t,"rgb(0,32,192)"),this.square(e,5,"rgba(0,128,192,0.5)")},t.drawutils.prototype.cubicBezierCurveHandleLines=function(t){this.cubicBezierHandleLines(t.startPoint,t.endPoint,t.startControlPoint,t.endControlPoint)},t.drawutils.prototype.handleLine=function(t,e){this.line(t,e,"rgb(192,192,192)")},t.drawutils.prototype.dot=function(t,e){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(Math.round(this.offset.x+this.scale.x*t.x),Math.round(this.offset.y+this.scale.y*t.y)),this.ctx.lineTo(Math.round(this.offset.x+this.scale.x*t.x+1),Math.round(this.offset.y+this.scale.y*t.y+1)),this.ctx.closePath(),this._fillOrDraw(e),this.ctx.restore()},t.drawutils.prototype.point=function(t,e){this.ctx.beginPath(),this.ctx.arc(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y,3,0,2*Math.PI,!1),this.ctx.closePath(),this._fillOrDraw(e)},t.drawutils.prototype.circle=function(t,e,i){this.ctx.beginPath(),this.ctx.ellipse(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y,e*this.scale.x,e*this.scale.y,0,0,2*Math.PI),this.ctx.closePath(),this._fillOrDraw(i)},t.drawutils.prototype.ellipse=function(t,e,i,s){this.ctx.beginPath(),this.ctx.ellipse(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y,e*this.scale.x,i*this.scale.y,0,0,2*Math.PI),this.ctx.closePath(),this._fillOrDraw(s)},t.drawutils.prototype.square=function(t,e,i){this.ctx.beginPath(),this.ctx.rect(this.offset.x+(t.x-e/2)*this.scale.x,this.offset.y+(t.y-e/2)*this.scale.y,e*this.scale.x,e*this.scale.y),this.ctx.closePath(),this._fillOrDraw(i)},t.drawutils.prototype.grid=function(t,e,i,s,r,n){this.ctx.beginPath();for(var o=0;o<e/2;)this.ctx.moveTo(this.offset.x+(t.x+o)*this.scale.x,this.offset.y-(t.y-.5*i)*this.scale.y),this.ctx.lineTo(this.offset.x+(t.x+o)*this.scale.x,this.offset.y-(t.y+.5*i)*this.scale.y),o+=s;for(o=s;o<e/2;)this.ctx.moveTo(this.offset.x+(t.x-o)*this.scale.x,this.offset.y-(t.y-.5*i)*this.scale.y),this.ctx.lineTo(this.offset.x+(t.x-o)*this.scale.x,this.offset.y-(t.y+.5*i)*this.scale.y),o+=s;for(var a=0;a<i/2;)this.ctx.moveTo(this.offset.x-(t.x-.5*e)*this.scale.x,this.offset.y+(t.y+a)*this.scale.y),this.ctx.lineTo(this.offset.x-(t.x+.5*e)*this.scale.x,this.offset.y+(t.y+a)*this.scale.y),a+=r;for(a=r;a<i/2;)this.ctx.moveTo(this.offset.x-(t.x-.5*e)*this.scale.x,this.offset.y+(t.y-a)*this.scale.y),this.ctx.lineTo(this.offset.x-(t.x+.5*e)*this.scale.x,this.offset.y+(t.y-a)*this.scale.y),a+=r;this.ctx.closePath(),this._fillOrDraw(n)},t.drawutils.prototype.raster=function(t,e,i,s,r,n){this.ctx.save(),this.ctx.beginPath();for(var o=0,a=-Math.ceil(.5*e/s)*s;a<e/2;a+=s){o++;for(var h=-Math.ceil(.5*i/r)*r;h<i/2;h+=r)1==o&&0,this.ctx.moveTo(this.offset.x+(t.x+a)*this.scale.x-4,this.offset.y+(t.y+h)*this.scale.y),this.ctx.lineTo(this.offset.x+(t.x+a)*this.scale.x+4,this.offset.y+(t.y+h)*this.scale.y),this.ctx.moveTo(this.offset.x+(t.x+a)*this.scale.x,this.offset.y+(t.y+h)*this.scale.y-4),this.ctx.lineTo(this.offset.x+(t.x+a)*this.scale.x,this.offset.y+(t.y+h)*this.scale.y+4)}this.ctx.strokeStyle=n,this.ctx.lineWidth=1,this.ctx.stroke(),this.ctx.closePath(),this.ctx.restore()},t.drawutils.prototype.diamondHandle=function(t,e,i){this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x-e/2,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y-e/2),this.ctx.lineTo(this.offset.x+t.x*this.scale.x+e/2,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y+e/2),this.ctx.closePath(),this._fillOrDraw(i)},t.drawutils.prototype.squareHandle=function(t,e,i){this.ctx.beginPath(),this.ctx.rect(this.offset.x+t.x*this.scale.x-e/2,this.offset.y+t.y*this.scale.y-e/2,e,e),this.ctx.closePath(),this._fillOrDraw(i)},t.drawutils.prototype.circleHandle=function(t,e,i){this.ctx.beginPath(),this.ctx.arc(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y,3,0,2*Math.PI,!1),this.ctx.closePath(),this._fillOrDraw(i)},t.drawutils.prototype.crosshair=function(t,e,i){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x-e,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+t.x*this.scale.x+e,this.offset.y+t.y*this.scale.y),this.ctx.moveTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y-e),this.ctx.lineTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y+e),this.ctx.strokeStyle=i,this.ctx.lineWidth=.5,this.ctx.stroke(),this.ctx.closePath(),this.ctx.restore()},t.drawutils.prototype.polygon=function(t,e){if(!(t.vertices.length<=1)){this.ctx.save(),this.ctx.beginPath(),this.ctx.lineWidth=1,this.ctx.moveTo(this.offset.x+t.vertices[0].x*this.scale.x,this.offset.y+t.vertices[0].y*this.scale.y);for(var i=0;i<t.vertices.length;i++)this.ctx.lineTo(this.offset.x+t.vertices[i].x*this.scale.x,this.offset.y+t.vertices[i].y*this.scale.y);!t.isOpen&&t.vertices.length>2&&this.ctx.closePath(),this._fillOrDraw(e),this.ctx.setLineDash([]),this.ctx.restore()}},t.drawutils.prototype.label=function(t,e,i,s){this.ctx.save(),this.ctx.translate(e,i),void 0!==s&&this.ctx.rotate(s),this.ctx.fillStyle="black",this.fillShapes?this.ctx.fillText(t,0,0):this.ctx.strokeText(t,0,0),this.ctx.restore()},t.drawutils.prototype.clear=function(t){this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}}(window||t.export)}).call(this,i(0)(t))},function(t,e){!function(t){"use strict";const e=8;var i=function(t,e,i){t.style["transform-origin"]="0 0",t.style.transform=1==e&&1==i?null:"scale("+e+","+i+")"};!function(t){var e=function(t,e){this.item=t,this.type=e,this.vindex=null,this.pindex=null,this.cindex=null};e.VERTEX="vertex",e.prototype.isVertex=function(){return this.type==e.VERTEX},e.prototype.setVIndex=function(t){return this.vindex=t,this},t.Draggable=e}(t),VertexAttr.model={bezierAutoAdjust:!1,renderTime:0,selectable:!0,isSelected:!1,draggable:!0};var s=function(n){if(void 0===(n=n||{}).canvas)throw"No canvas specified.";this.config={fullSize:r.val(n,"fullSize",!0),fitToParent:r.bool(n,"fitToParent",!0),scaleX:r.num(n,"scaleX",1),scaleY:r.num(n,"scaleY",1),drawGrid:r.bool(n,"drawGrid",!0),rasterGrid:r.bool(n,"rasterGrid",!0),rasterAdjustFactor:r.num(n,"rasterAdjustdFactror",2),drawOrigin:r.bool(n,"drawOrigin",!1),autoAdjustOffset:r.val(n,"autoAdjustOffset",!0),offsetAdjustXPercent:r.num(n,"offsetAdjustXPercent",50),offsetAdjustYPercent:r.num(n,"offsetAdjustYPercent",50),backgroundColor:n.backgroundColor||"#ffffff",redrawOnResize:r.bool(n,"redrawOnResize",!0),defaultCanvasWidth:r.num(n,"defaultCanvasWidth",1024),defaultCanvasHeight:r.num(n,"defaultCanvasHeight",768),canvasWidthFactor:r.num(n,"canvasWidthFactor",1),canvasHeightFactor:r.num(n,"canvasHeightFactor",1),cssScaleX:r.num(n,"cssScaleX",1),cssScaleY:r.num(n,"cssScaleY",1),cssUniformScale:r.bool(n,"cssUniformScale",!0),rebuild:function(){rebuild()},saveFile:function(){o.saveFile()},enableExport:r.bool(n,"enableExport",!0),drawBezierHandleLines:r.bool(n,"drawBezierHandleLines",!0),drawBezierHandlePoints:r.bool(n,"drawBezierHandlePoints",!0),drawHandleLines:r.bool(n,"drawHandleLines",!0),drawHandlePoints:r.bool(n,"drawHandlePoints",!0),preClear:r.func(n,"preClear",null),preDraw:r.func(n,"preDraw",null),postDraw:r.func(n,"postDraw",null),enableMouse:r.bool(n,"enableMouse",!0),enableTouch:r.bool(n,"enableTouch",!0),enableKeys:r.bool(n,"enableKeys",!0),enableMouseWheel:r.bool(n,"enableMouseWheel",!0),enableGL:r.bool(n,"enableGL",!1)},this.drawConfig={drawVertices:!0},this.canvas="string"==typeof n.canvas?document.getElementById(n.canvas):n.canvas,this.config.enableGL?(this.ctx=this.canvas.getContext("webgl"),this.draw=new drawutilsgl(this.ctx,!1),this.fill=this.draw.copyInstance(!0)):(this.ctx=this.canvas.getContext("2d"),this.draw=new drawutils(this.ctx,!1),this.fill=new drawutils(this.ctx,!0)),this.draw.scale.set(this.config.scaleX,this.config.scaleY),this.fill.scale.set(this.config.scaleX,this.config.scaleY),this.grid=new Grid(new Vertex(0,0),new Vertex(50,50)),this.image=null,this.imageBuffer=null,this.canvasSize={width:1024,height:768},this.vertices=[],this.selectPolygon=null,this.draggedElements=[],this.drawables=[],this.console=console;var o=this;this.hooks={saveFile:function(){var t=(new SVGBuilder).build(o.drawables,{canvasSize:o.canvasSize,offset:o.draw.offset,zoom:o.draw.scale}),e=new Blob([t],{type:"image/svg;charset=utf-8"});saveAs(e,"plot-boilerplate.svg")}},s.prototype.setConsole=function(t){if("function"!=typeof t.log)throw"Console object must have a 'log' function.";if("function"!=typeof t.warn)throw"Console object must have a 'warn' function.";if("function"!=typeof t.error)throw"Console object must have a 'error' function.";this.console=t},s.prototype.updateCSSscale=function(){this.config.cssUniformScale?i(this.canvas,this.config.cssScaleX,this.config.cssScaleX):i(this.canvas,this.config.cssScaleX,this.config.cssScaleY)},s.prototype.add=function(t,e){if(t instanceof Vertex)this.drawables.push(t),this.vertices.push(t);else if(t instanceof Line)this.drawables.push(t),this.vertices.push(t.a),this.vertices.push(t.b);else if(t instanceof Vector)this.drawables.push(t),this.vertices.push(t.a),this.vertices.push(t.b);else if(t instanceof VEllipse)this.vertices.push(t.center),this.vertices.push(t.axis),this.drawables.push(t),t.center.listeners.addDragListener(function(e){t.axis.add(e.params.dragAmount)});else if(t instanceof Polygon)for(var i in this.drawables.push(t),t.vertices)this.vertices.push(t.vertices[i]);else if(t instanceof BezierPath){for(var i in this.drawables.push(t),t.bezierCurves)t.adjustCircular||0!=i||this.vertices.push(t.bezierCurves[i].startPoint),this.vertices.push(t.bezierCurves[i].endPoint),this.vertices.push(t.bezierCurves[i].startControlPoint),this.vertices.push(t.bezierCurves[i].endControlPoint),t.bezierCurves[i].startControlPoint.attr.selectable=!1,t.bezierCurves[i].endControlPoint.attr.selectable=!1;for(var i in t.bezierCurves)t.bezierCurves[i].startPoint.listeners.addDragListener(function(e){var i=t.locateCurveByStartPoint(e.params.vertex);t.bezierCurves[i].startPoint.addXY(-e.params.dragAmount.x,-e.params.dragAmount.y),t.moveCurvePoint(1*i,t.START_POINT,e.params.dragAmount)}),t.bezierCurves[i].startControlPoint.listeners.addDragListener(function(e){var i=t.locateCurveByStartControlPoint(e.params.vertex);t.bezierCurves[i].startPoint.attr.bezierAutoAdjust&&t.adjustPredecessorControlPoint(1*i,!0,!0)}),t.bezierCurves[i].endControlPoint.listeners.addDragListener(function(e){var i=t.locateCurveByEndControlPoint(e.params.vertex);t.bezierCurves[i%t.bezierCurves.length].endPoint.attr.bezierAutoAdjust&&t.adjustSuccessorControlPoint(1*i,!0,!0)})}else{if(!(t instanceof PBImage))throw"Cannot add drawable of unrecognized type: "+t.constructor.name;this.vertices.push(t.upperLeft),this.vertices.push(t.lowerRight),this.drawables.push(t),t.upperLeft.listeners.addDragListener(function(e){t.lowerRight.add(e.params.dragAmount)}),t.lowerRight.attr.selectable=!1}(e||void 0===e)&&this.redraw()},s.prototype.remove=function(t,e){for(var i in t instanceof Vertex&&this.removeVertex(t,!1),this.drawables)if(this.drawables[i]===t)return this.drawables.splice(i,1),void(e&&this.redraw())},s.prototype.removeVertex=function(t,e){for(var i in this.drawables)if(this.vertices[i]===t)return this.vertices.splice(i,1),void(e&&this.redraw())},s.prototype.drawGrid=function(){var t=Grid.utils.mapRasterScale(this.config.rasterAdjustFactor,this.draw.scale.x),e=Grid.utils.mapRasterScale(this.config.rasterAdjustFactor,this.draw.scale.y),i={w:this.grid.size.x*t,h:this.grid.size.y*e},s=this.canvasSize.width/2,r=this.canvasSize.height/2,n=this.draw.offset.clone().inv();n.x=Math.round(n.x+s)/Math.round(i.w)*i.w/this.draw.scale.x+(this.draw.offset.x-s)/this.draw.scale.x%i.w,n.y=Math.round(n.y+r)/Math.round(i.h)*i.h/this.draw.scale.y+(this.draw.offset.y-r)/this.draw.scale.x%i.h,this.config.drawGrid&&(this.config.rasterGrid?this.draw.raster(n,this.canvasSize.width/this.draw.scale.x,this.canvasSize.height/this.draw.scale.y,i.w,i.h,"rgba(0,128,255,0.125)"):this.draw.grid(n,this.canvasSize.width/this.draw.scale.x,this.canvasSize.height/this.draw.scale.y,i.w,i.h,"rgba(0,128,255,0.095)"))},s.prototype.drawOrigin=function(){this.draw.crosshair({x:0,y:0},10,"#000000")},s.prototype.drawDrawables=function(t){for(var e in this.drawables){var i=this.drawables[e];if(i instanceof BezierPath)for(var s in i.bezierCurves)this.draw.cubicBezier(i.bezierCurves[s].startPoint,i.bezierCurves[s].endPoint,i.bezierCurves[s].startControlPoint,i.bezierCurves[s].endControlPoint,"#00a822"),this.config.drawBezierHandlePoints&&this.config.drawHandlePoints?(i.bezierCurves[s].startPoint.attr.bezierAutoAdjust||(this.draw.diamondHandle(i.bezierCurves[s].startPoint,7,"orange"),i.bezierCurves[s].startPoint.attr.renderTime=t),i.bezierCurves[s].endPoint.attr.bezierAutoAdjust||(this.draw.diamondHandle(i.bezierCurves[s].endPoint,7,"orange"),i.bezierCurves[s].endPoint.attr.renderTime=t),this.draw.circleHandle(i.bezierCurves[s].startControlPoint,7,"#008888"),this.draw.circleHandle(i.bezierCurves[s].endControlPoint,7,"#008888"),i.bezierCurves[s].startControlPoint.attr.renderTime=t,i.bezierCurves[s].endControlPoint.attr.renderTime=t):(i.bezierCurves[s].startPoint.attr.renderTime=t,i.bezierCurves[s].endPoint.attr.renderTime=t,i.bezierCurves[s].startControlPoint.attr.renderTime=t,i.bezierCurves[s].endControlPoint.attr.renderTime=t),this.config.drawBezierHandleLines&&this.config.drawHandleLines&&(this.draw.handleLine(i.bezierCurves[s].startPoint,i.bezierCurves[s].startControlPoint),this.draw.handleLine(i.bezierCurves[s].endPoint,i.bezierCurves[s].endControlPoint));else if(i instanceof Polygon){if(this.draw.polygon(i,"#0022a8"),!this.config.drawHandlePoints)for(var e in i.vertices)i.vertices[e].attr.renderTime=t}else i instanceof VEllipse?(this.config.drawHandleLines&&(this.draw.line(i.center.clone().add(0,i.axis.y-i.center.y),i.axis,"#c8c8c8"),this.draw.line(i.center.clone().add(i.axis.x-i.center.x,0),i.axis,"#c8c8c8")),this.draw.ellipse(i.center,Math.abs(i.axis.x-i.center.x),Math.abs(i.axis.y-i.center.y),"#2222a8"),this.config.drawHandlePoints||(i.center.attr.renderTime=t,i.axis.attr.renderTime=t)):i instanceof Vertex?!this.drawConfig.drawVertices||i.attr.selectable&&i.attr.draggable||(this.draw.circleHandle(i,7,"#a8a8a8"),i.attr.renderTime=t):i instanceof Line?(this.draw.line(i.a,i.b,"#a844a8"),this.config.drawHandlePoints&&i.a.attr.selectable||(i.a.attr.renderTime=t),this.config.drawHandlePoints&&i.b.attr.selectable||(i.b.attr.renderTime=t)):i instanceof Vector?(this.draw.arrow(i.a,i.b,"#ff44a8"),this.config.drawHandlePoints&&i.b.attr.selectable?this.draw.circleHandle(i.b,7,"#a8a8a8"):i.b.attr.renderTime=t,this.config.drawHandlePoints&&i.a.attr.selectable||(i.a.attr.renderTime=t),this.config.drawHandlePoints&&i.b.attr.selectable||(i.b.attr.renderTime=t)):i instanceof PBImage?(this.config.drawHandleLines&&this.draw.line(i.upperLeft,i.lowerRight,"#a8a8a8"),this.fill.image(i.image,i.upperLeft,i.lowerRight.clone().sub(i.upperLeft)),this.config.drawHandlePoints&&(this.draw.circleHandle(i.lowerRight,7,"#a8a8a8"),i.lowerRight.attr.renderTime=t)):this.console.error("Cannot draw object. Unknown class "+i.constructor.name+".")}},s.prototype.drawSelectPolygon=function(){null!=this.selectPolygon&&this.selectPolygon.vertices.length>0&&(this.draw.polygon(this.selectPolygon,"#888888"),this.draw.crosshair(this.selectPolygon.vertices[0],3,"#008888"))},s.prototype.drawVertices=function(t){for(var e in this.vertices)this.drawConfig.drawVertices&&this.vertices[e].attr.renderTime!=t&&this.draw.squareHandle(this.vertices[e],5,this.vertices[e].attr.isSelected?"rgba(192,128,0)":"rgb(0,128,192)")},s.prototype.redraw=function(){var t=(new Date).getTime();this.config.preClear&&this.config.preClear(),this.clear(),this.config.preDraw&&this.config.preDraw(),this.draw.beginDrawCycle(),this.fill.beginDrawCycle(),this.drawGrid(),this.config.drawOrigin&&this.drawOrigin(),this.drawDrawables(t),this.drawVertices(t),this.drawSelectPolygon(),this.config.postDraw&&this.config.postDraw()},s.prototype.clear=function(){this.draw.clear(this.config.backgroundColor)},s.prototype.clearSelection=function(t){for(var e in this.vertices)this.vertices[e].attr.isSelected=!1;return t&&this.redraw(),this},s.prototype.viewport=function(){return{min:this.transformMousePosition(0,0),max:this.transformMousePosition(this.canvasSize.width,this.canvasSize.height)}},s.prototype.saveFile=function(){this.hooks.saveFile()};s.prototype.resizeCanvas=function(){var t=function(t,e){t*=o.config.canvasWidthFactor,e*=o.config.canvasHeightFactor,o.canvas.width=t,o.canvas.height=e,o.canvasSize.width=t,o.canvasSize.height=e,o.config.autoAdjustOffset&&(o.draw.offset.x=o.fill.offset.x=t*(o.config.offsetAdjustXPercent/100),o.draw.offset.y=o.fill.offset.y=e*(o.config.offsetAdjustYPercent/100))};if(o.config.fullSize&&!o.config.fitToParent){var e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;o.canvas.style.position="absolute",o.canvas.style.width=e+"px",o.canvas.style.height=i+"px",o.canvas.style.top=0,o.canvas.style.left=0,t(e,i)}else if(o.config.fitToParent){o.canvas.style.position="absolute";var s=function(){var t=o.canvas.parentNode,e=o.canvas;e.style.display="none";var i=parseFloat(window.getComputedStyle(t,null).getPropertyValue("padding"))||0,s=parseFloat(window.getComputedStyle(e,null).getPropertyValue("border-width"))||0,r=parseFloat(window.getComputedStyle(t,null).getPropertyValue("padding-left"))||i,n=parseFloat(window.getComputedStyle(t,null).getPropertyValue("padding-right"))||i,a=parseFloat(window.getComputedStyle(t,null).getPropertyValue("padding-top"))||i,h=parseFloat(window.getComputedStyle(t,null).getPropertyValue("padding-bottom"))||i,l=parseFloat(window.getComputedStyle(e,null).getPropertyValue("border-left-width"))||s,c=parseFloat(window.getComputedStyle(e,null).getPropertyValue("border-right-width"))||s,u=parseFloat(window.getComputedStyle(e,null).getPropertyValue("border-top-width"))||s,f=parseFloat(window.getComputedStyle(e,null).getPropertyValue("border-bottom-width"))||s,d=t.clientWidth,p=t.clientHeight;return e.style.display="block",{width:d-r-n-l-c,height:p-a-h-u-f}}(o.canvas.parentNode);o.canvas.style.width=s.width+"px",o.canvas.style.height=s.height+"px",o.canvas.style.top=null,o.canvas.style.left=null,t(s.width,s.height)}else t(o.config.defaultCanvasWidth,o.config.defaultCanvasHeight);o.config.redrawOnResize&&o.redraw()},t.addEventListener("resize",this.resizeCanvas),this.resizeCanvas(),s.prototype.selectVerticesInPolygon=function(t){for(var e in this.vertices)t.containsVert(this.vertices[e])&&(this.vertices[e].attr.isSelected=!0)};var a=function(t,e){for(var i in void 0===e&&(e=7),e/=o.draw.scale.x,o.vertices){var s=o.vertices[i];if(s.distance(t)<e)return new Draggable(s,Draggable.VERTEX).setVIndex(i)}return!1};s.prototype.transformMousePosition=function(t,e){return{x:(t/this.config.cssScaleX-this.draw.offset.x)/this.draw.scale.x,y:(e/this.config.cssScaleY-this.draw.offset.y)/this.draw.scale.y}};if(this.config.enableMouse?new MouseHandler(this.canvas).down(function(t){if(1==t.which||window.TouchEvent&&t.originalEvent instanceof TouchEvent){var i=a(o.transformMousePosition(t.params.pos.x,t.params.pos.y),e/Math.min(o.config.cssScaleX,o.config.cssScaleY));if(i){if("vertex"==i.type&&o.vertices[i.vindex].attr.isSelected)for(var s in o.vertices)o.vertices[s].attr.isSelected&&(o.draggedElements.push(new Draggable(o.vertices[s],Draggable.VERTEX).setVIndex(s)),o.vertices[s].listeners.fireDragStartEvent(t));else{if(!o.vertices[i.vindex].attr.draggable)return;o.draggedElements.push(i),"bpath"==i.type?o.paths[i.pindex].bezierCurves[i.cindex].getPointByID(i.pid).listeners.fireDragStartEvent(t):"vertex"==i.type&&o.vertices[i.vindex].listeners.fireDragStartEvent(t)}o.redraw()}}}).drag(function(t){var e={x:t.params.dragAmount.x,y:t.params.dragAmount.y};if(t.params.dragAmount.x/=o.config.cssScaleX,t.params.dragAmount.y/=o.config.cssScaleY,f.isDown("alt")||f.isDown("ctrl")||f.isDown("spacebar"))o.draw.offset.add(t.params.dragAmount),o.fill.offset.set(o.draw.offset),o.redraw();else for(var i in t.params.dragAmount.x/=o.draw.scale.x,t.params.dragAmount.y/=o.draw.scale.y,o.draggedElements){var s=o.draggedElements[i];if("bpath"==s.type)o.paths[s.pindex].moveCurvePoint(s.cindex,s.pid,t.params.dragAmount),o.paths[s.pindex].bezierCurves[s.cindex].getPointByID(s.pid).listeners.fireDragEvent(t);else if("vertex"==s.type){if(!o.vertices[s.vindex].attr.draggable)continue;o.vertices[s.vindex].add(t.params.dragAmount),o.vertices[s.vindex].listeners.fireDragEvent(t)}}t.params.dragAmount.x=e.x,t.params.dragAmount.y=e.y,o.redraw()}).up(function(t){if(1==t.which){for(var i in t.params.wasDragged||function(t,i){var s=a(o.transformMousePosition(t,i),e/Math.min(o.config.cssScaleX,o.config.cssScaleY));if(s)if(f.isDown("shift")){if("bpath"==s.type){let t=o.paths[s.pindex].bezierCurves[s.cindex].getPointByID(s.pid);t.attr.selectable&&(t.attr.isSelected=!t.attr.isSelected)}else if("vertex"==s.type){let t=o.vertices[s.vindex];t.attr.selectable&&(t.attr.isSelected=!t.attr.isSelected)}o.redraw()}else f.isDown("y")&&(o.vertices[s.vindex].attr.bezierAutoAdjust=!o.vertices[s.vindex].attr.bezierAutoAdjust,o.redraw());else if(null!=o.selectPolygon){var r=o.transformMousePosition(t,i);o.selectPolygon.vertices.push(r),o.redraw()}}(t.params.pos.x,t.params.pos.y),o.draggedElements){var s=o.draggedElements[i];"bpath"==s.type?o.paths[s.pindex].bezierCurves[s.cindex].getPointByID(s.pid).listeners.fireDragEndEvent(t):"vertex"==s.type&&o.vertices[s.vindex].listeners.fireDragEndEvent(t)}o.draggedElements=[],o.redraw()}}):o.console.log("Mouse interaction disabled."),this.config.enableMouseWheel?new MouseHandler(this.canvas).wheel(function(t){t.deltaY<0?(o.draw.scale.x=o.fill.scale.x=o.config.scaleX=1.25*o.config.scaleX,o.draw.scale.y=o.fill.scale.y=o.config.scaleY=1.25*o.config.scaleY):t.deltaY>0&&(o.draw.scale.x=o.fill.scale.x=o.config.scaleX=Math.max(o.config.scaleX/1.25,.01),o.draw.scale.y=o.fill.scale.y=o.config.scaleY=Math.max(o.config.scaleY/1.25,.01)),t.preventDefault(),o.redraw()}):o.console.log("Mouse wheel interaction disabled."),this.config.enableTouch){function h(t){return{x:t.x-o.canvas.offsetLeft,y:t.y-o.canvas.offsetTop}}var l=null,c=null,u=null;new Touchy(this.canvas,{one:function(t,e){l=new Vertex(h(e.lastPoint)),c=new Vertex(h(e.lastPoint)),(u=a(o.transformMousePosition(l.x,l.y),32/Math.min(o.config.cssScaleX,o.config.cssScaleY)))&&t.on("move",function(t){var e=h(t[0]),i=o.transformMousePosition(e.x,e.y),s=new Vertex(o.transformMousePosition(l.x,l.y)).difference(i);if("vertex"==u.type){if(!o.vertices[u.vindex].attr.draggable)return;o.vertices[u.vindex].add(s);var r={params:{dragAmount:s.clone(),wasDragged:!0,mouseDownPos:c.clone(),mouseDragPos:c.clone().add(s)}};o.vertices[u.vindex].listeners.fireDragEvent(r),o.redraw()}l=new Vertex(e)})}})}else o.console.log("Touch interaction disabled.");if(this.config.enableKeys)var f=new KeyHandler({trackAll:!0}).down("escape",function(){o.clearSelection(!0)}).down("shift",function(){o.selectPolygon=new Polygon,o.redraw()}).up("shift",function(){null!=o.selectPolygon&&(o.selectVerticesInPolygon(o.selectPolygon),o.selectPolygon=null,o.redraw())}).down("e",function(){o.console.log("e was hit. shift is pressed?",f.isDown("shift"))});else o.console.log("Keyboard interaction disabled.");this.updateCSSscale(),this.redraw(),this.canvas.focus()};s.prototype.createGUI=function(){var t=new dat.gui.GUI,e=this;t.remember(this.config);var i=t.addFolder("Editor settings"),s=i.addFolder("Canvas size");s.add(this.config,"fullSize").onChange(function(){e.resizeCanvas()}).title("Toggles the fullpage mode."),s.add(this.config,"fitToParent").onChange(function(){e.resizeCanvas()}).title("Toggles the fit-to-parent mode to fit to parent container (overrides fullsize)."),s.add(this.config,"defaultCanvasWidth").min(1).step(10).onChange(function(){e.resizeCanvas()}).title("Specifies the fallback width."),s.add(this.config,"defaultCanvasHeight").min(1).step(10).onChange(function(){e.resizeCanvas()}).title("Specifies the fallback height."),s.add(this.config,"canvasWidthFactor").min(.1).step(.1).max(10).onChange(function(){e.resizeCanvas()}).title("Specifies a factor for the current width."),s.add(this.config,"canvasHeightFactor").min(.1).step(.1).max(10).onChange(function(){e.resizeCanvas()}).title("Specifies a factor for the current height."),s.add(this.config,"cssScaleX").min(.01).step(.01).max(1).onChange(function(){e.config.cssUniformScale&&(e.config.cssScaleY=e.config.cssScaleX),e.updateCSSscale()}).title("Specifies the visual x scale (CSS).").listen(),s.add(this.config,"cssScaleY").min(.01).step(.01).max(1).onChange(function(){e.config.cssUniformScale&&(e.config.cssScaleX=e.config.cssScaleY),e.updateCSSscale()}).title("Specifies the visual y scale (CSS).").listen(),s.add(this.config,"cssUniformScale").onChange(function(){e.config.cssUniformScale&&(e.config.cssScaleY=e.config.cssScaleX),e.updateCSSscale()}).title("CSS uniform scale (x-scale equlsa y-scale).");var r=i.addFolder("Draw settings");(r.add(this.config,"drawBezierHandlePoints").onChange(function(){e.redraw()}).title("Draw Bézier handle points."),r.add(this.config,"drawBezierHandleLines").onChange(function(){e.redraw()}).title("Draw Bézier handle lines."),r.add(this.config,"drawHandlePoints").onChange(function(){e.redraw()}).title("Draw handle points (overrides all other settings)."),r.add(this.config,"drawHandleLines").onChange(function(){e.redraw()}).title("Draw handle lines in general (overrides all other settings)."),r.add(this.drawConfig,"drawVertices").onChange(function(){e.redraw()}).title("Draw vertices in general."),i.add(this.config,"scaleX").title("Scale x.").min(.01).max(10).step(.01).onChange(function(){e.draw.scale.x=e.fill.scale.x=e.config.scaleX,e.redraw()}).listen(),i.add(this.config,"scaleY").title("Scale y.").min(.01).max(10).step(.01).onChange(function(){e.draw.scale.y=e.fill.scale.y=e.config.scaleY,e.redraw()}).listen(),i.add(this.config,"rasterGrid").title("Draw a fine raster instead a full grid.").onChange(function(){e.redraw()}).listen(),i.add(this.config,"redrawOnResize").title("Automatically redraw the data if window or canvas is resized.").listen(),i.addColor(this.config,"backgroundColor").onChange(function(){e.redraw()}).title("Choose a background color."),this.config.enableExport)&&t.addFolder("Export").add(this.config,"saveFile").name("Save a file").title("Save as SVG.");return t},s.utils={safeMergeByKeys:function(t,e){for(var i in t)if(e.hasOwnProperty(i)){var s=typeof t[i];try{"boolean"==s?t[i]=!!JSON.parse(e[i]):"number"==s?t[i]=1*JSON.parse(e[i]):("function"==s&&typeofextension[i],t[i]=e[i])}catch(t){_self.console.error("error in key ",i,e[i],t)}}return t},buildArrowHead:function(t,e,i,s,r){var n=Math.atan2((e.y-t.y)*r,(e.x-t.x)*s),o=[];return o.push(new Vertex(e.x*s-i*Math.cos(n),e.y*r-i*Math.sin(n))),o.push(new Vertex(e.x*s-1.35*i*Math.cos(n-Math.PI/8),e.y*r-1.35*i*Math.sin(n-Math.PI/8))),o.push(new Vertex(e.x*s,e.y*r)),o.push(new Vertex(e.x*s-1.35*i*Math.cos(n+Math.PI/8),e.y*r-1.35*i*Math.sin(n+Math.PI/8))),o}};let r={val:function(t,e,i){return t.hasOwnProperty(e)?void 0===t[e]?i:t[e]:i},num:function(t,e,i){return t.hasOwnProperty(e)?"number"!=typeof t[e]?i:t[e]:i},bool:function(t,e,i){return t.hasOwnProperty(e)?"boolean"!=typeof t[e]?i:t[e]:i},func:function(t,e,i){return t.hasOwnProperty(e)?"function"!=typeof t[e]?i:t[e]:i}};t.PlotBoilerplate=s}(window)},function(t,e,i){(function(t){t.export,PlotBoilerplate.RectSelector=function(t,e,i,s){var r=document.getElementById(e),n={xMin:0,yMin:0,xMax:0,yMax:0};new MouseHandler(r).up(function(t){0==t.button&&(r.style.display="none",console.log("xMin",n.xMin,"yMin",n.yMin,"xMax",n.xMax,"yMax",n.yMax),n.xMin!=n.xMax&&n.yMin!=n.yMax&&s(n))}),new MouseHandler(t.canvas).down(function(e){if(0==e.button){r.style.display="inherit",r.style.left=e.clientX+"px",r.style.top=e.clientY+"px",r.style.width="1px",r.style.height="1px";var s=t.transformMousePosition(e.params.mouseDownPos.x,e.params.mouseDownPos.y);n.xMin=n.xMax=i.unNormalizeX(s.x),n.yMin=n.yMax=i.unNormalizeY(s.y)}}).up(function(t){0==t.button&&(console.log("up"),r.style.display="none",console.log("xMin",n.xStart,"yMin",n.yStart,"xMax",n.xEnd,"yMax",n.yEnd),n.xMin!=n.xMax&&n.yMin!=n.yMax&&s(n))}).drag(function(e){if(0==e.button){var s=e.params.mouseDownPos.x,o=e.params.mouseDownPos.y,a=e.params.pos.x,h=e.params.pos.y,l=t.transformMousePosition(e.params.pos.x,e.params.pos.y);n.xMax=i.unNormalizeX(l.x),n.yMax=i.unNormalizeY(l.y),r.style.width=a-s+"px",r.style.height=h-o+"px"}})}}).call(this,i(0)(t))}]);